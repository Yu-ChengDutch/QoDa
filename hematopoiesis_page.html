<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="style.css" />

</head>
<body>

    <a style="display:blcok" href="./development_and_growth.html">
        <div class="main-card">
            <h4><b>Hematopoiesis</b></h4>
        </div>
    </a>

    <div class="card" id="initial">
    </div>

    <div id="placeholder">

    </div>

    <script>
        function clickPress(event, subsequent_cells) {
            console.log("Click function correctly loaded!");
            
            let inputVal = document.getElementsById("inputId").value;

            let card = document.getElementById('testCard');

            var answers = [];

            for (key in Object.keys(subsequent_cells)) {
                answers.push(subsequent_cells[key].Name);
            } 

            console.log("Answers: " + answers);
            
            if (event.key == "Enter") {
                if (answers.includes(inputVal)){
                    var div = document.createElement('div');

                    div.innerHTML = `
                        <div class="card">
                            <h4>${inputVal}</h4>
                        </div>
                    `;

                    document.body.insertBefore(div, document.getElementById("placeholder"));
                } else {
                    alert("Oops, this is not correct.");
                }                
            }
        };
    
    </script>

    <script>
        console.log("Accessing JS")

        card = document.getElementById('initial');

        fetch('./hematopoiesis.json')
            .then(function (response) {
                console.log("File found and accessed")
                return response.json();
            })
            .then(function (data) {
                console.log(data)

                var name = data["Name"];

                let html_insert = "<h4>" + name + "<h4>";

                card.innerHTML += html_insert;

                card.addEventListener("click", addQuestion.bind(null, data["Subsequent cells"], name));

            })
            .catch(function (err) {
                console.log('error: ' + err);
            });

        function addQuestion(subsequent_cells, name) {

            var list_length = Object.keys(subsequent_cells).length.toString();

            var introduction = `${name} has ${list_length} of subsequent cells.`;
            var question = "Please enter these, one by one.";

            var div = document.createElement('div');

            div.innerHTML=`
                <div class="card">

                    <h4>${introduction}</h4>
            
                    <input type="text" placeholders="Type here" id="inputId" class="inputClass" onkeypress="clickPress(event, ${subsequent_cells});">
            
                    <h4>${question}</h4>
            
                </div>
            `;

            document.body.insertBefore(div, document.getElementById("placeholder"))

        };

        function addCards(listOfThings) {
            console.log(listOfThings);
            for (key in Object.keys(listOfThings)) {
                thing = listOfThings[key]
                console.log()
                console.log(thing["Name"]);
                var div = document.createElement('div');
                var name = thing["Name"];

                div.innerHTML = `
                    <div class="card">
                        <h4>${name}</h4>
                    </div>
                `;

                document.body.insertBefore(div, document.body.childNodes[0])
            }
        }

    </script>
</body>
</html>